---
import Base from "../layouts/Layout.astro";
import { Icon } from "astro-icon/components";
import fs from 'fs';
import yaml from 'js-yaml';

// Load YAML
const ateliers = yaml.load(fs.readFileSync('./src/content/ateliers.yaml', 'utf8'));

// Sort years descending
const sortedYears = Object.keys(ateliers).sort((a, b) => Number(b) - Number(a));
---

<Base title="Le calligraphe">
  <main class="mx-auto max-w-[735px] mt-14">

    <h1></h1>
    <h2 class="text-4xl lg:text-5xl font-bold text-gray-600">Le calligraphe</h2>
    <p class="text-lg mt-4 text-gray-600">
      Je suis calligraphe depuis plus de trente ans et m'intéresse particulièrement aux langues et civilisations asiatiques.
    </p>

    <p>
Christophe Desmur, lyonnais de naissance, calligraphe, passionné par les langues et cultures du monde, je suis titulaire d’un diplôme d’étude universitaire générale en langue et civilisation coréennes, d’une maîtrise de langue et civilisation chinoises ainsi que d’un master de traduction littéraire du chinois vers le français.
</p>

<img
  src="/assets/pinceaux-encre-chine-christophe-desmur-calligraphie-chinoise.webp"
  alt="Christophe Desmur, calligraphie chinoise à Lyon, pinceaux et encre de Chine."
  style="width:100%; max-width:800px; height:auto;"
>

<p>
Je donne des cours de calligraphie et des cours de chinois individuels ou en groupe aussi bien aux enfants qu’aux adultes et anime également des stages ( 10 élèves maximum ).</p>

    <h2 class="text-4xl lg:text-3xl font-bold text-gray-600">Ateliers & interventions</h2>

    <!-- Year navigation -->
    <nav class="flex flex-wrap gap-4 mb-6">
      {sortedYears.map((annee) => (
        <button
          class="year-btn px-4 py-2 rounded bg-gray-200 hover:bg-gray-300 font-semibold"
          data-year={annee}
        >
          {annee}
        </button>
      ))}
    </nav>

    <!-- Yearly sections -->
    {sortedYears.map((annee, idx) => (
      <section
        key={annee}
        class={`year-section ${idx === 0 ? '' : 'hidden'}`}
        data-year={annee}
      >
        <h3 class="text-2xl font-bold text-gray-600">{annee}</h3>
        <ul class="mt-4 space-y-2">
          {ateliers[annee].map((event) => (
            <li key={event.date + event.titre} class="border-b pb-2">
              <strong>{event.date}</strong> — {event.titre} <br />
              <em>{event.lieu}</em><br />
              {event.details}
            </li>
          ))}
        </ul>
      </section>
    ))}
  </main>

  <!-- Small script to handle year browsing -->
  <script>
    document.querySelectorAll(".year-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        const year = btn.dataset.year;
        document.querySelectorAll(".year-section").forEach(sec => {
          sec.classList.toggle("hidden", sec.dataset.year !== year);
        });
      });
    });
  </script>
</Base>
